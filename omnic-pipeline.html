<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Omni-C Sequencing Â· Bioinformatics Pipeline</title>

<style>
  :root {
    --bg:       #ffffff;
    --bg2:      #f8f9fb;
    --bg3:      #f0f2f6;
    --surface:  #f0f3f8;
    --surface2: #e8ecf4;
    --border:   #d0d7e3;
    --accent1:  #0891b2;   /* teal */
    --accent2:  #d97706;   /* amber */
    --accent3:  #7c3aed;   /* purple */
    --accent4:  #16a34a;   /* green */
    --accent5:  #dc2626;   /* red */
    --accent6:  #2563eb;   /* blue */
    --text:     #1a202c;
    --muted:    #4a5568;
    --dim:      #a0aec0;
    --mono:     'Courier New', Courier, monospace;
    --sans:     Arial, Helvetica, sans-serif;
    --display:  Arial, Helvetica, sans-serif;
  }

  * { margin:0; padding:0; box-sizing:border-box; }

  html { scroll-behavior: smooth; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: var(--sans);
    font-size: 15px;
    line-height: 1.7;
    overflow-x: hidden;
  }

  /* â”€â”€ NOISE OVERLAY â”€â”€ */
  body::before {
    content: '';
    position: fixed; inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.04'/%3E%3C/svg%3E");
    pointer-events: none; z-index: 0; opacity: 0.15;
  }

  /* â”€â”€ NAV â”€â”€ */
  nav {
    position: sticky; top: 0; z-index: 100;
    background: rgba(255,255,255,0.92);
    backdrop-filter: blur(16px);
    border-bottom: 1px solid var(--border);
    display: flex; align-items: center; justify-content: space-between;
    padding: 0 2.5rem; height: 56px;
  }
  .nav-logo {
    font-family: var(--mono); font-size: 13px; color: var(--accent1);
    letter-spacing: 0.05em;
  }
  .nav-links { display: flex; gap: 2rem; }
  .nav-links a {
    font-size: 13px; color: var(--muted); text-decoration: none;
    transition: color 0.2s; font-family: var(--mono); letter-spacing: 0.03em;
  }
  .nav-links a:hover { color: var(--accent1); }

  /* â”€â”€ HERO â”€â”€ */
  .hero {
    position: relative; overflow: hidden;
    padding: 10rem 2.5rem 7rem;
    text-align: center;
    background: linear-gradient(160deg, #eef6fb 0%, #ffffff 60%);
  }
  .hero-grid {
    position: absolute; inset: 0;
    background-image:
      linear-gradient(var(--border) 1px, transparent 1px),
      linear-gradient(90deg, var(--border) 1px, transparent 1px);
    background-size: 48px 48px;
    opacity: 0.2;
    mask-image: radial-gradient(ellipse 80% 60% at 50% 50%, black 30%, transparent 100%);
  }
  .hero-glow {
    position: absolute; top: -80px; left: 50%; transform: translateX(-50%);
    width: 700px; height: 400px;
    background: radial-gradient(ellipse, rgba(8,145,178,0.08) 0%, transparent 70%);
    pointer-events: none;
  }
  .hero-tag {
    display: inline-block;
    font-family: var(--mono); font-size: 11px; letter-spacing: 0.15em;
    color: var(--accent1); border: 1px solid var(--accent1);
    padding: 0.3rem 0.9rem; border-radius: 2px; margin-bottom: 1.5rem;
    text-transform: uppercase;
    animation: fadeUp 0.6s ease both;
  }
  .hero h1 {
    font-family: var(--display); font-size: clamp(2.8rem, 7vw, 5rem);
    font-weight: 800; line-height: 1.1;
    color: var(--text);
    animation: fadeUp 0.6s 0.1s ease both;
  }
  .hero h1 span { color: var(--accent1); }
  .hero-sub {
    margin-top: 1.2rem; font-size: 1.05rem; color: var(--muted);
    max-width: 560px; margin-left: auto; margin-right: auto;
    animation: fadeUp 0.6s 0.2s ease both;
  }
  .hero-meta {
    display: flex; justify-content: center; gap: 2rem; margin-top: 2.5rem;
    flex-wrap: wrap;
    animation: fadeUp 0.6s 0.3s ease both;
  }
  .hero-badge {
    display: flex; align-items: center; gap: 0.5rem;
    font-family: var(--mono); font-size: 12px; color: var(--muted);
  }
  .hero-badge .dot { width: 6px; height: 6px; border-radius: 50%; }

  /* â”€â”€ TABS â”€â”€ */
  .tab-container {
    display: flex; justify-content: center; gap: 0;
    margin: 3rem auto 0; max-width: 460px;
    border: 1px solid var(--border); border-radius: 6px; overflow: hidden;
    animation: fadeUp 0.6s 0.4s ease both;
  }
  .tab-btn {
    flex: 1; padding: 0.75rem 1.5rem;
    background: transparent; border: none; cursor: pointer;
    font-family: var(--mono); font-size: 12px; letter-spacing: 0.05em;
    color: var(--muted); transition: all 0.2s;
    text-transform: uppercase;
  }
  .tab-btn:first-child { border-right: 1px solid var(--border); }
  .tab-btn.active { background: var(--accent1); color: var(--bg); font-weight: 700; }
  .tab-btn:not(.active):hover { background: var(--surface); color: var(--text); }

  /* â”€â”€ MAIN LAYOUT â”€â”€ */
  main { max-width: 1000px; margin: 0 auto; padding: 3rem 2rem 6rem; }

  .panel { display: none; }
  .panel.active {
    display: block;
    animation: fadeUp 0.4s ease both;
  }

  /* â”€â”€ SECTION TITLE â”€â”€ */
  .section-title {
    display: flex; align-items: center; gap: 1rem;
    margin: 3rem 0 1.5rem;
  }
  .section-title h2 {
    font-family: var(--display); font-size: 1.5rem; font-weight: 800;
    color: var(--text);
  }
  .section-line { flex: 1; height: 1px; background: var(--border); }
  .section-num {
    font-family: var(--mono); font-size: 11px; color: var(--accent2);
    border: 1px solid var(--accent2); padding: 0.2rem 0.5rem; border-radius: 2px;
  }

  /* â”€â”€ PIPELINE FLOW â”€â”€ */
  .pipeline { display: flex; flex-direction: column; gap: 0; }

  /* START / END nodes */
  .flow-terminal {
    display: flex; align-items: center; justify-content: center;
    padding: 0.9rem 1.5rem;
    border-radius: 40px;
    font-family: var(--mono); font-size: 13px; font-weight: 700;
    letter-spacing: 0.06em; text-align: center;
    margin: 0 auto; width: fit-content; min-width: 360px;
  }
  .flow-terminal.start {
    background: linear-gradient(135deg, rgba(79,209,197,0.2), rgba(79,209,197,0.05));
    border: 2px solid var(--accent1); color: var(--accent1);
  }
  .flow-terminal.end {
    background: linear-gradient(135deg, rgba(104,211,145,0.2), rgba(104,211,145,0.05));
    border: 2px solid var(--accent4); color: var(--accent4);
  }

  /* Arrow connector */
  .flow-arrow {
    display: flex; flex-direction: column; align-items: center;
    padding: 0.4rem 0; gap: 0;
  }
  .flow-arrow .arrow-line {
    width: 2px; height: 28px;
    background: linear-gradient(to bottom, var(--border), var(--accent1));
  }
  .flow-arrow .arrow-head {
    width: 0; height: 0;
    border-left: 7px solid transparent;
    border-right: 7px solid transparent;
    border-top: 10px solid var(--accent1);
    margin-top: -1px;
  }
  .flow-arrow .arrow-label {
    font-family: var(--mono); font-size: 10px; color: var(--muted);
    margin-top: 4px; letter-spacing: 0.04em; font-style: italic;
  }

  /* Step card */
  .step-card {
    display: grid;
    grid-template-columns: 56px 1fr 180px;
    border: 1px solid var(--border);
    border-radius: 8px;
    overflow: hidden;
    background: var(--surface);
    transition: transform 0.2s, border-color 0.2s, box-shadow 0.2s;
    cursor: default;
  }
  .step-card:hover {
    transform: translateY(-2px);
    border-color: var(--accent1);
    box-shadow: 0 8px 32px rgba(8,145,178,0.12);
  }

  .step-num {
    display: flex; align-items: center; justify-content: center;
    font-family: var(--display); font-size: 1.8rem; font-weight: 800;
    color: var(--bg);
    min-height: 90px;
  }
  .step-body { padding: 1rem 1.2rem; }
  .step-title {
    font-family: var(--display); font-size: 1rem; font-weight: 800;
    margin-bottom: 0.2rem;
  }
  .step-subtitle {
    font-family: var(--mono); font-size: 11px; color: var(--muted);
    letter-spacing: 0.04em; margin-bottom: 0.6rem;
    text-transform: uppercase;
  }
  .step-tools { display: flex; flex-direction: column; gap: 3px; }
  .step-tool {
    font-size: 13px; color: var(--muted);
    display: flex; align-items: flex-start; gap: 0.4rem;
  }
  .step-tool::before { content: 'âš™'; font-size: 11px; margin-top: 2px; flex-shrink: 0; }

  .step-meta {
    border-left: 1px solid var(--border);
    padding: 0.8rem 1rem;
    display: flex; flex-direction: column; justify-content: center; gap: 0.6rem;
    background: var(--bg3);
  }
  .meta-row { }
  .meta-label {
    font-family: var(--mono); font-size: 10px; letter-spacing: 0.1em;
    text-transform: uppercase; margin-bottom: 2px;
  }
  .meta-val { font-size: 12px; color: var(--muted); line-height: 1.4; }

  /* Color themes for step num */
  .c-teal  { background: var(--accent1); }
  .c-amber { background: var(--accent2); }
  .c-purple{ background: var(--accent3); }
  .c-green { background: var(--accent4); }
  .c-blue  { background: var(--accent6); }
  .c-red   { background: var(--accent5); }

  .meta-label.c-teal-t   { color: var(--accent1); }
  .meta-label.c-amber-t  { color: var(--accent2); }
  .meta-label.c-purple-t { color: var(--accent3); }
  .meta-label.c-green-t  { color: var(--accent4); }
  .meta-label.c-blue-t   { color: var(--accent6); }
  .meta-label.c-red-t    { color: var(--accent5); }

  /* â”€â”€ TABLES â”€â”€ */
  .data-table {
    width: 100%; border-collapse: collapse;
    border-radius: 8px; overflow: hidden;
    border: 1px solid var(--border);
    font-size: 13.5px;
  }
  .data-table thead tr { background: var(--surface); }
  .data-table th {
    padding: 0.75rem 1rem; text-align: left;
    font-family: var(--mono); font-size: 11px; letter-spacing: 0.08em;
    color: var(--accent1); border-bottom: 1px solid var(--border);
    text-transform: uppercase; font-weight: 400;
  }
  .data-table td {
    padding: 0.65rem 1rem; border-bottom: 1px solid var(--border);
    color: var(--muted);
  }
  .data-table tr:last-child td { border-bottom: none; }
  .data-table tbody tr:nth-child(even) { background: var(--bg2); }
  .data-table tbody tr:hover { background: var(--surface2); }
  .tag {
    display: inline-block; padding: 0.15rem 0.5rem;
    border-radius: 3px; font-family: var(--mono);
    font-size: 11px; font-weight: 700;
  }
  .tag-green  { background: rgba(22,163,74,0.12); color: var(--accent4); }
  .tag-red    { background: rgba(220,38,38,0.1);  color: var(--accent5); }
  .tag-amber  { background: rgba(217,119,6,0.1);  color: var(--accent2); }

  .qc-group-label {
    font-size: 13px; font-weight: 700; color: var(--muted);
    letter-spacing: 0.04em; text-transform: uppercase;
    margin: 0.5rem 0 0.5rem;
    padding: 0.4rem 0.8rem;
    background: var(--surface);
    border-left: 3px solid var(--accent1);
    border-radius: 0 4px 4px 0;
  }
  .qc-badge {
    display: inline-block; padding: 0.1rem 0.45rem;
    border-radius: 3px; font-size: 10px; font-weight: 700;
    background: rgba(8,145,178,0.12); color: var(--accent1);
    vertical-align: middle; margin-left: 4px; letter-spacing: 0.04em;
  }
  .data-table td { vertical-align: top; font-size: 13px; line-height: 1.6; }

  /* â”€â”€ CODE BLOCK â”€â”€ */
  .code-block {
    background: #1e2433;
    border: 1px solid #2d3650;
    border-radius: 8px;
    overflow: hidden;
    margin: 1.2rem 0;
  }
  .code-header {
    display: flex; align-items: center; justify-content: space-between;
    padding: 0.6rem 1rem;
    background: #252d42;
    border-bottom: 1px solid #2d3650;
  }
  .code-lang {
    font-family: var(--mono); font-size: 11px; color: var(--accent2);
    letter-spacing: 0.08em; text-transform: uppercase;
  }
  .code-dots { display: flex; gap: 6px; }
  .code-dots span { width: 10px; height: 10px; border-radius: 50%; }
  pre {
    padding: 1.2rem 1.5rem;
    font-family: var(--mono); font-size: 12.5px; line-height: 1.8;
    color: #e2e8f0; overflow-x: auto;
  }
  .cm { color: var(--muted); }     /* comment */
  .ck { color: var(--accent1); }   /* keyword/flag */
  .cv { color: var(--accent2); }   /* value */
  .cp { color: var(--accent4); }   /* path */
  .cc { color: var(--accent3); }   /* command */

  /* â”€â”€ ANALYSIS CARDS (downstream) â”€â”€ */
  .analysis-card {
    border: 1px solid var(--border);
    border-radius: 10px;
    overflow: hidden;
    background: var(--surface);
    margin-bottom: 1rem;
    transition: transform 0.2s, box-shadow 0.2s;
  }
  .analysis-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(0,0,0,0.1);
  }
  .analysis-header {
    display: grid; grid-template-columns: 6px 1fr;
  }
  .analysis-accent { min-height: 100%; }
  .analysis-header-body { padding: 1rem 1.2rem 0.8rem; }
  .analysis-title {
    font-family: var(--display); font-size: 1.1rem; font-weight: 800;
    display: flex; align-items: center; gap: 0.5rem;
  }
  .analysis-desc {
    font-size: 13.5px; color: var(--muted); margin-top: 0.4rem; line-height: 1.6;
  }
  .analysis-footer {
    display: grid; grid-template-columns: 1fr 1fr 1fr;
    border-top: 1px solid var(--border);
    background: var(--bg3);
  }
  .analysis-meta {
    padding: 0.65rem 1rem;
    border-right: 1px solid var(--border);
  }
  .analysis-meta:last-child { border-right: none; }
  .analysis-meta-label {
    font-family: var(--mono); font-size: 10px; letter-spacing: 0.1em;
    text-transform: uppercase; margin-bottom: 3px;
  }
  .analysis-meta-val { font-size: 12.5px; color: var(--muted); }
  .analysis-tools { padding: 0.8rem 1.2rem 1rem; }
  .analysis-tools-label {
    font-family: var(--mono); font-size: 10px; letter-spacing: 0.1em;
    color: var(--muted); text-transform: uppercase; margin-bottom: 0.5rem;
  }
  .tool-pills { display: flex; flex-wrap: wrap; gap: 6px; }
  .tool-pill {
    padding: 0.2rem 0.7rem;
    border-radius: 20px;
    font-family: var(--mono); font-size: 11.5px;
    border: 1px solid;
  }

  /* â”€â”€ GRID 2-COL â”€â”€ */
  .grid-2 {
    display: grid; grid-template-columns: 1fr 1fr;
    gap: 1rem; margin: 1rem 0;
  }
  .info-card {
    border: 1px solid var(--border); border-radius: 8px;
    padding: 1.2rem; background: var(--surface);
  }
  .info-card h4 {
    font-family: var(--display); font-size: 0.95rem; font-weight: 800;
    margin-bottom: 0.5rem;
  }
  .info-card p { font-size: 13px; color: var(--muted); line-height: 1.6; }

  /* â”€â”€ INTEGRATION TABLE â”€â”€ */
  .integration-grid {
    display: grid; grid-template-columns: repeat(3, 1fr); gap: 1px;
    background: var(--border); border-radius: 8px; overflow: hidden;
    border: 1px solid var(--border); margin: 1rem 0;
  }
  .ig-cell {
    background: var(--surface); padding: 0.9rem 1rem;
  }
  .ig-head {
    background: var(--bg3);
    font-family: var(--mono); font-size: 11px; color: var(--accent1);
    letter-spacing: 0.08em; text-transform: uppercase; font-weight: 700;
  }
  .ig-cell .ig-main { font-size: 13.5px; margin-bottom: 0.2rem; color: var(--text); }
  .ig-cell .ig-sub  { font-size: 12px; color: var(--muted); }

  /* â”€â”€ DEPTH TABLE â”€â”€ */
  .depth-card {
    border: 1px solid var(--border); border-radius: 8px;
    overflow: hidden; margin: 1rem 0;
  }
  .depth-row {
    display: grid; grid-template-columns: 160px 200px 1fr;
    border-bottom: 1px solid var(--border);
    align-items: center;
  }
  .depth-row:last-child { border-bottom: none; }
  .depth-row > div { padding: 0.75rem 1rem; }
  .depth-row.hdr { background: var(--surface); }
  .depth-row.hdr div {
    font-family: var(--mono); font-size: 11px; color: var(--accent1);
    letter-spacing: 0.08em; text-transform: uppercase;
  }
  .depth-row:not(.hdr):nth-child(even) { background: var(--bg2); }
  .depth-row:not(.hdr) div:first-child {
    font-family: var(--mono); font-size: 12px; color: var(--accent2);
  }
  .depth-row:not(.hdr) div:nth-child(2) { color: var(--text); font-size: 13.5px; }
  .depth-row:not(.hdr) div:nth-child(3) { color: var(--muted); font-size: 13px; }

  /* â”€â”€ NOTICE BOX â”€â”€ */
  .notice {
    border-radius: 8px; padding: 1rem 1.2rem;
    display: flex; gap: 0.8rem; align-items: flex-start;
    margin: 1.2rem 0;
  }
  .notice-icon { font-size: 1.1rem; flex-shrink: 0; margin-top: 2px; }
  .notice p { font-size: 13.5px; color: var(--muted); }
  .notice p strong { color: var(--text); }
  .notice.warn {
    background: rgba(217,119,6,0.07);
    border: 1px solid rgba(217,119,6,0.3);
  }
  .notice.info {
    background: rgba(8,145,178,0.07);
    border: 1px solid rgba(8,145,178,0.25);
  }
  .notice.tip {
    background: rgba(22,163,74,0.07);
    border: 1px solid rgba(22,163,74,0.25);
  }

  /* â”€â”€ FOOTER â”€â”€ */
  footer {
    border-top: 1px solid var(--border);
    background: var(--bg2);
    padding: 2.5rem 2.5rem;
  }
  .footer-inner {
    max-width: 1000px; margin: 0 auto;
    display: flex; align-items: center; justify-content: space-between;
    flex-wrap: wrap; gap: 1.5rem;
  }
  .footer-author { display: flex; align-items: center; gap: 1rem; }
  .footer-avatar {
    width: 44px; height: 44px; border-radius: 50%;
    background: linear-gradient(135deg, var(--accent1), var(--accent6));
    display: flex; align-items: center; justify-content: center;
    font-size: 1.1rem; font-weight: 800; color: #fff;
    flex-shrink: 0; font-family: Arial, sans-serif;
  }
  .footer-name {
    font-size: 15px; font-weight: 700; color: var(--text);
    font-family: Arial, sans-serif;
  }
  .footer-links {
    display: flex; gap: 0.75rem; margin-top: 4px; flex-wrap: wrap;
  }
  .footer-link {
    display: inline-flex; align-items: center; gap: 5px;
    font-family: 'Courier New', monospace; font-size: 12px;
    color: var(--muted); text-decoration: none;
    padding: 0.2rem 0.6rem;
    border: 1px solid var(--border); border-radius: 4px;
    transition: all 0.2s;
  }
  .footer-link:hover { border-color: var(--accent1); color: var(--accent1); background: rgba(8,145,178,0.05); }
  .footer-right {
    text-align: right; font-family: 'Courier New', monospace;
    font-size: 11.5px; color: var(--dim); line-height: 1.8;
  }

  /* â”€â”€ ANIMATIONS â”€â”€ */
  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(18px); }
    to   { opacity: 1; transform: translateY(0); }
  }

  /* â”€â”€ RESPONSIVE â”€â”€ */
  @media (max-width: 700px) {
    .step-card { grid-template-columns: 44px 1fr; }
    .step-meta { display: none; }
    .grid-2 { grid-template-columns: 1fr; }
    .analysis-footer { grid-template-columns: 1fr; }
    .integration-grid { grid-template-columns: 1fr; }
    .depth-row { grid-template-columns: 1fr 1fr; }
    .hero h1 { font-size: 2rem; }
    nav { padding: 0 1rem; }
    main { padding: 2rem 1rem 4rem; }
  }
</style>
</head>
<body>

<!-- NAV -->
<nav>
  <div class="nav-logo">// omni-c Â· pipeline Â· Mai TN Nguyen</div>
  <div class="nav-links">
    <a href="#pipeline">Preprocessing</a>
    <a href="#downstream">Downstream</a>
    <a href="#tools">Tools</a>
  </div>
</nav>

<!-- HERO -->
<header class="hero">
  <div class="hero-grid"></div>
  <div class="hero-glow"></div>
  <div class="hero-tag">Bioinformatics Pipeline</div>
  <h1>Omni-C Sequencing<br><span>Data Analysis</span></h1>
  <p class="hero-sub">A complete guide to preprocessing and downstream 3D genome analysis using Dovetail Genomics Omni-C proximity ligation data.</p>
  <p style="margin-top:0.8rem;font-size:13px;color:var(--muted)">
    by <a href="https://github.com/maitnnguyen" target="_blank" style="color:var(--accent1);text-decoration:none;font-weight:600">Mai TN Nguyen</a>
    &nbsp;Â·&nbsp;
    <a href="mailto:ntnmai303@gmail.com" style="color:var(--muted);text-decoration:none">ntnmai303@gmail.com</a>
  </p>
  <div class="hero-meta">
    <div class="hero-badge"><span class="dot" style="background:var(--accent1)"></span>Restriction enzyme-free</div>
    <div class="hero-badge"><span class="dot" style="background:var(--accent2)"></span>Uniform genome coverage</div>
    <div class="hero-badge"><span class="dot" style="background:var(--accent3)"></span>3D genome architecture</div>
    <div class="hero-badge"><span class="dot" style="background:var(--accent4)"></span>pairtools + cooler stack</div>
  </div>
  <div class="tab-container">
    <button class="tab-btn active" onclick="showTab('preprocessing')">01 Â· Preprocessing</button>
    <button class="tab-btn" onclick="showTab('downstream')">02 Â· Downstream</button>
  </div>
</header>

<!-- MAIN -->
<main>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- PANEL 1 â€” PREPROCESSING                               -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="panel-preprocessing" class="panel active">

  <div id="pipeline"></div>

  <!-- OVERVIEW -->
  <div class="notice info" style="margin-top:0">
    <div class="notice-icon">â„¹</div>
    <p><strong>Overview:</strong> This pipeline converts raw Omni-C FASTQ reads into a normalized multi-resolution contact matrix (.mcool). Unlike Hi-C, Omni-C is restriction enzyme-free â€” do not apply restriction site filtering. Tools follow the <strong>distiller-nf / pairtools + cooler</strong> framework.</p>
  </div>

  <!-- PIPELINE -->
  <div class="section-title">
    <div class="section-num">01</div>
    <h2>Pipeline Flow</h2>
    <div class="section-line"></div>
  </div>

  <div class="pipeline">

    <div class="flow-terminal start">â–¶ &nbsp; INPUT: Raw Omni-C FASTQ Files &nbsp;(R1 + R2)</div>

    <div class="flow-arrow"><div class="arrow-line"></div><div class="arrow-head"></div></div>

    <!-- Step 1 -->
    <div class="step-card">
      <div class="step-num c-teal">1</div>
      <div class="step-body">
        <div class="step-title" style="color:var(--accent1)">Quality Control</div>
        <div class="step-subtitle">Read Assessment</div>
        <div class="step-tools">
          <span class="step-tool">FastQC â€” per-read base quality, adapter content, GC bias</span>
          <span class="step-tool">MultiQC â€” aggregate QC across all samples into one report</span>
          <span class="step-tool">fastp â€” optional adapter trimming (rarely needed for Omni-C)</span>
        </div>
      </div>
      <div class="step-meta">
        <div class="meta-row"><div class="meta-label c-teal-t">INPUT</div><div class="meta-val">Raw FASTQ (R1 + R2)</div></div>
        <div class="meta-row"><div class="meta-label c-teal-t">OUTPUT</div><div class="meta-val">QC reports (.html / .txt)</div></div>
      </div>
    </div>

    <div class="flow-arrow"><div class="arrow-line"></div><div class="arrow-head"></div><div class="arrow-label">proceed if mapping rate expected > 75%</div></div>

    <!-- Step 2 -->
    <div class="step-card">
      <div class="step-num c-purple">2</div>
      <div class="step-body">
        <div class="step-title" style="color:var(--accent3)">Read Alignment</div>
        <div class="step-subtitle">Independent End Mapping â€” CRITICAL STEP</div>
        <div class="step-tools">
          <span class="step-tool">BWA-MEM with -SP -5M flags for chimeric read handling</span>
          <span class="step-tool">Chromap â€” faster Hi-C-native alternative to BWA-MEM</span>
          <span class="step-tool">âš  Each read end must be aligned INDEPENDENTLY, NOT as paired-end</span>
        </div>
      </div>
      <div class="step-meta">
        <div class="meta-row"><div class="meta-label c-purple-t">INPUT</div><div class="meta-val">FASTQ + Reference genome (.fa)</div></div>
        <div class="meta-row"><div class="meta-label c-purple-t">OUTPUT</div><div class="meta-val">BAM file (unsorted)</div></div>
      </div>
    </div>

    <div class="flow-arrow"><div class="arrow-line"></div><div class="arrow-head"></div></div>

    <!-- Step 3 -->
    <div class="step-card">
      <div class="step-num c-amber">3</div>
      <div class="step-body">
        <div class="step-title" style="color:var(--accent2)">Contact Parsing</div>
        <div class="step-subtitle">Ligation Junction Extraction</div>
        <div class="step-tools">
          <span class="step-tool">pairtools parse â€” extract genomic pairs from BAM alignments</span>
          <span class="step-tool">Classifies pair types: UU, NU, NN, WW, DD (see table below)</span>
          <span class="step-tool">Min mapping quality: MAPQ â‰¥ 30 recommended</span>
        </div>
      </div>
      <div class="step-meta">
        <div class="meta-row"><div class="meta-label c-amber-t">INPUT</div><div class="meta-val">BAM file</div></div>
        <div class="meta-row"><div class="meta-label c-amber-t">OUTPUT</div><div class="meta-val">Unsorted .pairs.gz</div></div>
      </div>
    </div>

    <div class="flow-arrow"><div class="arrow-line"></div><div class="arrow-head"></div></div>

    <!-- Step 4 -->
    <div class="step-card">
      <div class="step-num c-green">4</div>
      <div class="step-body">
        <div class="step-title" style="color:var(--accent4)">Sorting</div>
        <div class="step-subtitle">Coordinate Sort for Deduplication</div>
        <div class="step-tools">
          <span class="step-tool">pairtools sort â€” sort by chromosome + genomic position</span>
          <span class="step-tool">Required step before deduplication can be performed</span>
          <span class="step-tool">Use --nproc flag to parallelize across all available cores</span>
        </div>
      </div>
      <div class="step-meta">
        <div class="meta-row"><div class="meta-label c-green-t">INPUT</div><div class="meta-val">Unsorted .pairs.gz</div></div>
        <div class="meta-row"><div class="meta-label c-green-t">OUTPUT</div><div class="meta-val">Sorted .pairs.gz</div></div>
      </div>
    </div>

    <div class="flow-arrow"><div class="arrow-line"></div><div class="arrow-head"></div></div>

    <!-- Step 5 -->
    <div class="step-card">
      <div class="step-num c-red">5</div>
      <div class="step-body">
        <div class="step-title" style="color:var(--accent5)">Deduplication</div>
        <div class="step-subtitle">PCR Duplicate Removal</div>
        <div class="step-tools">
          <span class="step-tool">pairtools dedup â€” position-based duplicate marking and removal</span>
          <span class="step-tool">Handles both optical and PCR duplicates</span>
          <span class="step-tool">Target duplication rate: &lt; 20% (reject if &gt; 40%)</span>
        </div>
      </div>
      <div class="step-meta">
        <div class="meta-row"><div class="meta-label c-red-t">INPUT</div><div class="meta-val">Sorted .pairs.gz</div></div>
        <div class="meta-row"><div class="meta-label c-red-t">OUTPUT</div><div class="meta-val">Dedup .pairs.gz + stats</div></div>
      </div>
    </div>

    <div class="flow-arrow"><div class="arrow-line"></div><div class="arrow-head"></div></div>

    <!-- Step 6 -->
    <div class="step-card">
      <div class="step-num c-teal">6</div>
      <div class="step-body">
        <div class="step-title" style="color:var(--accent1)">QC Statistics</div>
        <div class="step-subtitle">Library Quality Assessment</div>
        <div class="step-tools">
          <span class="step-tool">pairtools stats â€” cis/trans ratio, pair type breakdown, distance distribution</span>
          <span class="step-tool">pairix â€” index .pairs file for random access queries</span>
          <span class="step-tool">Review QC thresholds before proceeding to binning</span>
        </div>
      </div>
      <div class="step-meta">
        <div class="meta-row"><div class="meta-label c-teal-t">INPUT</div><div class="meta-val">Dedup .pairs.gz</div></div>
        <div class="meta-row"><div class="meta-label c-teal-t">OUTPUT</div><div class="meta-val">Stats report + .pairix index</div></div>
      </div>
    </div>

    <div class="flow-arrow"><div class="arrow-line"></div><div class="arrow-head"></div><div class="arrow-label">filter to valid unique pairs (UU only)</div></div>

    <!-- Step 7 -->
    <div class="step-card">
      <div class="step-num c-blue">7</div>
      <div class="step-body">
        <div class="step-title" style="color:var(--accent6)">Contact Binning</div>
        <div class="step-subtitle">Contact Matrix Generation</div>
        <div class="step-tools">
          <span class="step-tool">cooler cload pairs â€” bin pairs into genome-wide matrix at 1kb base resolution</span>
          <span class="step-tool">cooler zoomify â€” generate multi-resolution .mcool</span>
          <span class="step-tool">Resolutions: 1kb, 5kb, 10kb, 25kb, 50kb, 100kb, 250kb, 500kb, 1Mb</span>
        </div>
      </div>
      <div class="step-meta">
        <div class="meta-row"><div class="meta-label c-blue-t">INPUT</div><div class="meta-val">Valid .pairs + chromsizes</div></div>
        <div class="meta-row"><div class="meta-label c-blue-t">OUTPUT</div><div class="meta-val">.cool + .mcool matrix</div></div>
      </div>
    </div>

    <div class="flow-arrow"><div class="arrow-line"></div><div class="arrow-head"></div></div>

    <!-- Step 8 -->
    <div class="step-card">
      <div class="step-num c-green">8</div>
      <div class="step-body">
        <div class="step-title" style="color:var(--accent4)">Normalization</div>
        <div class="step-subtitle">Iterative Correction & Bias Removal</div>
        <div class="step-tools">
          <span class="step-tool">cooler balance â€” ICE normalization across all resolutions</span>
          <span class="step-tool">Corrects for: GC content, mappability, fragment length biases</span>
          <span class="step-tool">KR normalization available via Juicer tools (.hic format alternative)</span>
        </div>
      </div>
      <div class="step-meta">
        <div class="meta-row"><div class="meta-label c-green-t">INPUT</div><div class="meta-val">.cool / .mcool</div></div>
        <div class="meta-row"><div class="meta-label c-green-t">OUTPUT</div><div class="meta-val">Balanced .mcool âœ“ FINAL</div></div>
      </div>
    </div>

    <div class="flow-arrow"><div class="arrow-line"></div><div class="arrow-head"></div></div>

    <div class="flow-terminal end">âœ“ &nbsp; OUTPUT: Normalized .mcool â†’ Ready for Downstream Analysis</div>

  </div><!-- end .pipeline -->

  <!-- QC TABLE -->
  <div class="section-title" style="margin-top:3rem">
    <div class="section-num">02</div>
    <h2>QC Thresholds</h2>
    <div class="section-line"></div>
  </div>

  <p style="color:var(--muted);font-size:13.5px;margin-bottom:1.2rem;line-height:1.7">
    These metrics are computed primarily from <strong style="color:var(--text)">pairtools stats</strong> output after deduplication.
    Cis/trans ratio is the single most informative indicator of Omni-C library quality â€”
    a low ratio typically points to over-digestion, poor ligation, or sample degradation.
    Check all criteria before proceeding to contact matrix generation.
  </p>

  <!-- Group 1: Library Quality -->
  <div class="qc-group-label">ğŸ“Š &nbsp; Library Quality</div>
  <table class="data-table" style="margin-bottom:1.5rem">
    <thead>
      <tr><th>QC Metric</th><th>Minimum</th><th>Target</th><th>Fail â†’ Likely Cause</th><th>Biological Meaning</th></tr>
    </thead>
    <tbody>
      <tr>
        <td><strong>Cis/trans ratio</strong> <span class="qc-badge">Primary</span></td>
        <td>&gt; 40%</td>
        <td><span class="tag tag-green">&gt; 60%</span></td>
        <td><span class="tag tag-red">Poor ligation / degraded DNA</span></td>
        <td>Cis contacts reflect genuine 3D proximity within a chromosome. Trans contacts are mostly noise. A high cis ratio = successful proximity ligation. Values &lt; 30% usually indicate a failed library.</td>
      </tr>
      <tr>
        <td><strong>Long-range cis (&gt; 20 kb)</strong> <span class="qc-badge">Primary</span></td>
        <td>&gt; 20%</td>
        <td><span class="tag tag-green">&gt; 40%</span></td>
        <td><span class="tag tag-red">Incomplete crosslinking / over-digestion</span></td>
        <td>Short-range cis contacts (&lt; 1 kb) often reflect unligated fragments or self-circularization. Long-range cis pairs are the biologically informative signal for TADs, loops, and compartments. This metric filters signal from noise.</td>
      </tr>
      <tr>
        <td><strong>PCR duplication rate</strong></td>
        <td>&lt; 40%</td>
        <td><span class="tag tag-green">&lt; 20%</span></td>
        <td><span class="tag tag-amber">Low input DNA / over-amplification</span></td>
        <td>Duplicates inflate contact counts at specific loci and introduce false hotspots in the contact matrix. High duplication = low library complexity, meaning you are sequencing the same molecules repeatedly rather than unique ligation products.</td>
      </tr>
      <tr>
        <td><strong>Valid pair rate (UU %)</strong></td>
        <td>&gt; 50%</td>
        <td><span class="tag tag-green">&gt; 70%</span></td>
        <td><span class="tag tag-amber">Poor reference genome / repeat-rich regions</span></td>
        <td>The fraction of read pairs classified as Unique-Unique (both ends unambiguously mapped). Low UU% wastes sequencing cost â€” most reads cannot be used for contact analysis.</td>
      </tr>
    </tbody>
  </table>

  <!-- Group 2: Sequencing & Alignment -->
  <div class="qc-group-label">ğŸ”¬ &nbsp; Sequencing &amp; Alignment</div>
  <table class="data-table" style="margin-bottom:1.5rem">
    <thead>
      <tr><th>QC Metric</th><th>Minimum</th><th>Target</th><th>Fail â†’ Likely Cause</th><th>Biological Meaning</th></tr>
    </thead>
    <tbody>
      <tr>
        <td><strong>Overall mapping rate</strong></td>
        <td>&gt; 75%</td>
        <td><span class="tag tag-green">&gt; 90%</span></td>
        <td><span class="tag tag-amber">Contamination / wrong reference</span></td>
        <td>Percentage of reads that align to the reference genome at all. Low mapping usually indicates sample contamination (e.g. mycoplasma), a mismatch between sample and reference, or poor read quality. Check FastQC first.</td>
      </tr>
      <tr>
        <td><strong>Unique mapping rate (MAPQ â‰¥ 30)</strong></td>
        <td>&gt; 60%</td>
        <td><span class="tag tag-green">&gt; 80%</span></td>
        <td><span class="tag tag-amber">Repeat-rich genome / short reads</span></td>
        <td>Only uniquely mapped reads contribute to valid pairs. In repeat-rich or poorly assembled genomes, a large fraction of reads will be multimappers. Increasing read length (2Ã—150 bp) improves this.</td>
      </tr>
      <tr>
        <td><strong>Valid pairs (total unique)</strong></td>
        <td>&gt; 50M</td>
        <td><span class="tag tag-green">&gt; 200â€“400M</span></td>
        <td><span class="tag tag-red">Under-sequenced library</span></td>
        <td>The absolute number of usable contact pairs. This determines which features you can call: &lt;100M = compartments only; 100â€“300M = TADs; &gt;300M = loops. Deep sequencing (&gt;1B) needed for sub-compartment or allele-specific analysis.</td>
      </tr>
      <tr>
        <td><strong>Read pair distance distribution</strong></td>
        <td>Bimodal peak visible</td>
        <td><span class="tag tag-green">Clear decay + enrichment &gt; 10 kb</span></td>
        <td><span class="tag tag-red">Failed ligation or wrong assay</span></td>
        <td>A healthy Omni-C library shows a characteristic power-law decay of contact frequency with genomic distance, with enrichment at &gt;10â€“20 kb indicating true 3D contacts. A flat or exponentially decaying distribution with no long-range enrichment suggests ligation failure.</td>
      </tr>
    </tbody>
  </table>

  <!-- Group 3: Omni-C Specific -->
  <div class="qc-group-label">âš— &nbsp; Omni-C Specific (vs. Hi-C)</div>
  <table class="data-table" style="margin-bottom:1.5rem">
    <thead>
      <tr><th>QC Metric</th><th>Minimum</th><th>Target</th><th>Fail â†’ Likely Cause</th><th>Biological Meaning</th></tr>
    </thead>
    <tbody>
      <tr>
        <td><strong>Genome coverage uniformity</strong></td>
        <td>CV &lt; 0.5</td>
        <td><span class="tag tag-green">CV &lt; 0.3</span></td>
        <td><span class="tag tag-amber">MNase over/under-digestion</span></td>
        <td>Unlike Hi-C which has restriction site bias, Omni-C should produce near-uniform genome coverage since MNase cuts DNA randomly. Non-uniform coverage suggests suboptimal MNase titration. Check per-chromosome coverage in the .cool matrix.</td>
      </tr>
      <tr>
        <td><strong>Restriction site enrichment</strong></td>
        <td>Should be ABSENT</td>
        <td><span class="tag tag-green">No enrichment</span></td>
        <td><span class="tag tag-red">Hi-C reagent contamination</span></td>
        <td>A key advantage of Omni-C over Hi-C: contact junctions should NOT cluster at restriction sites. If you see restriction site enrichment in your Omni-C data, the protocol may have been contaminated with restriction enzyme or you may have mixed up samples.</td>
      </tr>
      <tr>
        <td><strong>Fragment size distribution</strong></td>
        <td>100â€“600 bp peak</td>
        <td><span class="tag tag-green">~200 bp median</span></td>
        <td><span class="tag tag-amber">Over-digestion (&lt;100 bp) or under-digestion (&gt;1 kb)</span></td>
        <td>Omni-C uses MNase which should produce nucleosome-sized fragments (~200 bp). Check the Bioanalyzer/TapeStation trace. Over-digestion produces sub-nucleosomal fragments and reduces library complexity; under-digestion reduces ligation efficiency.</td>
      </tr>
      <tr>
        <td><strong>Walk pairs (WW %)</strong></td>
        <td>&lt; 20%</td>
        <td><span class="tag tag-green">&lt; 10%</span></td>
        <td><span class="tag tag-amber">Very short fragments / over-digestion</span></td>
        <td>Walk pairs arise from reads that span more than one ligation junction â€” a read that contains 3+ alignment segments. High WW% indicates the DNA was cut too finely, producing very short fragments that ligate in tandem. These cannot be used for contact analysis.</td>
      </tr>
    </tbody>
  </table>

  <!-- Cis/Trans explainer -->
  <div class="notice info" style="margin-top:0.5rem">
    <div class="notice-icon">ğŸ“</div>
    <div>
      <p style="margin-bottom:0.5rem"><strong>Understanding the Cis/Trans ratio in detail</strong></p>
      <p>The cis/trans ratio is calculated as: <code style="background:#e8f0fe;padding:2px 6px;border-radius:3px;font-size:12px">cis_pairs / (cis_pairs + trans_pairs)</code></p>
      <p style="margin-top:0.5rem">Cis pairs = both loci on the <em>same chromosome</em>. Trans pairs = loci on <em>different chromosomes</em>. In a successful Omni-C experiment, chromatin folding means that most DNA in physical proximity is on the same chromosome â€” so the cis ratio should be high. Trans contacts are enriched at nuclear periphery and in gene-dense regions but most are effectively random ligation noise. A cis ratio below 40% almost always indicates library failure and the sample should be re-prepared rather than sequenced more deeply.</p>
    </div>
  </div>

  <!-- PAIR TYPES -->
  <div class="section-title">
    <div class="section-num">03</div>
    <h2>Pair Type Classification</h2>
    <div class="section-line"></div>
  </div>

  <table class="data-table">
    <thead>
      <tr><th>Code</th><th>Type</th><th>Description</th><th>Action</th></tr>
    </thead>
    <tbody>
      <tr><td><code style="color:var(--accent4)">UU</code></td><td>Uniqueâ€“Unique</td><td>Both ends uniquely mapped to genome</td><td><span class="tag tag-green">âœ“ KEEP</span></td></tr>
      <tr><td><code style="color:var(--accent2)">NU</code></td><td>Near-Unique</td><td>One end multimapped but rescued by MAPQ</td><td><span class="tag tag-amber">Optional</span></td></tr>
      <tr><td><code style="color:var(--accent5)">NN</code></td><td>Not-Unique</td><td>Both ends multimapped â€” ambiguous location</td><td><span class="tag tag-red">âœ— DISCARD</span></td></tr>
      <tr><td><code style="color:var(--accent5)">WW</code></td><td>Walk</td><td>More than 2 alignments detected per read</td><td><span class="tag tag-red">âœ— DISCARD</span></td></tr>
      <tr><td><code style="color:var(--accent5)">DD</code></td><td>Duplicate</td><td>PCR or optical duplicate of another pair</td><td><span class="tag tag-red">âœ— REMOVE</span></td></tr>
    </tbody>
  </table>

  <!-- COMMANDS -->
  <div class="section-title">
    <div class="section-num">04</div>
    <h2>Key Commands</h2>
    <div class="section-line"></div>
  </div>

  <div class="code-block">
    <div class="code-header">
      <span class="code-lang">bash</span>
      <div class="code-dots"><span style="background:#fc8181"></span><span style="background:#f6ad55"></span><span style="background:#68d391"></span></div>
    </div>
    <pre><span class="cm"># â”€â”€ Step 2: Alignment (independent end mapping) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="cc">bwa</span> mem <span class="ck">-SP5M</span> <span class="cp">ref.fa R1.fastq.gz R2.fastq.gz</span> \
  | <span class="cc">samtools</span> view <span class="ck">-bS</span> - > <span class="cp">aligned.bam</span>

<span class="cm"># â”€â”€ Step 3+4: Parse + Sort â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="cc">pairtools</span> parse <span class="ck">--min-mapq 30 --walks-policy mask</span> \
  <span class="ck">--max-inter-align-gap 30 --nproc-in 8 --nproc-out 8</span> \
  <span class="ck">-c</span> <span class="cp">genome.chromsizes</span> <span class="cp">aligned.bam</span> \
  | <span class="cc">pairtools</span> sort <span class="ck">--nproc 16</span> <span class="ck">-o</span> <span class="cp">sorted.pairs.gz</span>

<span class="cm"># â”€â”€ Step 5: Deduplication â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="cc">pairtools</span> dedup <span class="ck">--nproc-in 8 --nproc-out 8</span> \
  <span class="ck">--mark-dups --output-stats</span> <span class="cp">stats.txt</span> \
  <span class="ck">-o</span> <span class="cp">dedup.pairs.gz sorted.pairs.gz</span>

<span class="cm"># â”€â”€ Step 7: Bin contacts at 1kb base resolution â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="cc">cooler</span> cload pairs <span class="ck">-c1 2 -p1 3 -c2 4 -p2 5</span> \
  <span class="cv">genome.chromsizes:1000</span> <span class="cp">dedup.pairs.gz output.1000.cool</span>

<span class="cm"># â”€â”€ Step 7: Generate multi-resolution .mcool â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="cc">cooler</span> zoomify <span class="ck">--nproc 8</span> \
  <span class="ck">-r</span> <span class="cv">1000,5000,10000,25000,50000,100000,250000,500000,1000000</span> \
  <span class="cp">output.1000.cool</span> <span class="ck">-o</span> <span class="cp">output.mcool</span>

<span class="cm"># â”€â”€ Step 8: ICE normalization â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span>
<span class="cc">cooler</span> balance <span class="cp">output.mcool::/resolutions/10000</span>
<span class="cc">cooler</span> balance <span class="cp">output.mcool::/resolutions/100000</span></pre>
  </div>

  <div class="notice warn">
    <div class="notice-icon">âš </div>
    <p><strong>Omni-C vs Hi-C:</strong> Do not apply restriction site filtering or distance-based ligation artifact removal that is standard for Hi-C. Omni-C cuts DNA randomly via MNase, so there are no expected restriction fragments to filter against.</p>
  </div>

</div><!-- end panel-preprocessing -->


<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<!-- PANEL 2 â€” DOWNSTREAM                                  -->
<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="panel-downstream" class="panel">
  <div id="downstream"></div>

  <div class="notice info" style="margin-top:0">
    <div class="notice-icon">â„¹</div>
    <p><strong>Starting point:</strong> All analyses below begin from a normalized <strong>.mcool file</strong> output from the preprocessing pipeline. Feature calling resolution scales with sequencing depth â€” see the depth guide at the bottom.</p>
  </div>

  <!-- PHASE 1 -->
  <div class="section-title">
    <div class="section-num">Phase 1</div>
    <h2>Genome-Scale Organization <span style="color:var(--muted);font-weight:400;font-size:0.9rem">â€” Megabase resolution</span></h2>
    <div class="section-line"></div>
  </div>

  <div class="analysis-card">
    <div class="analysis-header">
      <div class="analysis-accent" style="background:var(--accent6)"></div>
      <div class="analysis-header-body">
        <div class="analysis-title" style="color:var(--accent6)">ğŸ§¬ &nbsp; A/B Compartment Analysis</div>
        <p class="analysis-desc">Classify the genome into active (A) and inactive (B) compartments via the first eigenvector (PC1) of the observed/expected contact matrix. Positive PC1 = A compartment (euchromatin, gene-rich); negative = B (heterochromatin). Validate against gene expression or H3K27ac signal.</p>
      </div>
    </div>
    <div class="analysis-tools">
      <div class="analysis-tools-label">Tools</div>
      <div class="tool-pills">
        <span class="tool-pill" style="border-color:var(--accent6);color:var(--accent6)">cooltools eigs-cis</span>
        <span class="tool-pill" style="border-color:var(--accent6);color:var(--accent6)">cooltools eigs-trans</span>
        <span class="tool-pill" style="border-color:var(--border);color:var(--muted)">HOMER</span>
      </div>
    </div>
    <div class="analysis-footer">
      <div class="analysis-meta"><div class="analysis-meta-label" style="color:var(--accent6)">Input</div><div class="analysis-meta-val">.mcool (100kbâ€“1Mb)</div></div>
      <div class="analysis-meta"><div class="analysis-meta-label" style="color:var(--accent6)">Output</div><div class="analysis-meta-val">Bedgraph (eigenvectors)</div></div>
      <div class="analysis-meta"><div class="analysis-meta-label" style="color:var(--accent6)">Resolution</div><div class="analysis-meta-val">100kb â€“ 1Mb</div></div>
    </div>
  </div>

  <!-- PHASE 2 -->
  <div class="section-title">
    <div class="section-num">Phase 2</div>
    <h2>Domain-Level Organization <span style="color:var(--muted);font-weight:400;font-size:0.9rem">â€” 10â€“500 kb resolution</span></h2>
    <div class="section-line"></div>
  </div>

  <div class="analysis-card">
    <div class="analysis-header">
      <div class="analysis-accent" style="background:var(--accent4)"></div>
      <div class="analysis-header-body">
        <div class="analysis-title" style="color:var(--accent4)">ğŸ“ &nbsp; Topologically Associating Domains (TADs)</div>
        <p class="analysis-desc">Identify self-interacting chromatin domains (100kbâ€“1Mb) that constrain enhancerâ€“promoter communication. TAD boundaries are enriched for convergent CTCF sites. Disrupted boundaries are associated with ectopic gene activation in cancer and developmental disorders.</p>
      </div>
    </div>
    <div class="analysis-tools">
      <div class="analysis-tools-label">Tools</div>
      <div class="tool-pills">
        <span class="tool-pill" style="border-color:var(--accent4);color:var(--accent4)">TopDom</span>
        <span class="tool-pill" style="border-color:var(--accent4);color:var(--accent4)">cooltools insulation</span>
        <span class="tool-pill" style="border-color:var(--border);color:var(--muted)">HiCseg</span>
        <span class="tool-pill" style="border-color:var(--border);color:var(--muted)">hicFindTADs</span>
      </div>
    </div>
    <div class="analysis-footer">
      <div class="analysis-meta"><div class="analysis-meta-label" style="color:var(--accent4)">Input</div><div class="analysis-meta-val">.mcool (10kbâ€“40kb)</div></div>
      <div class="analysis-meta"><div class="analysis-meta-label" style="color:var(--accent4)">Output</div><div class="analysis-meta-val">BED + insulation score</div></div>
      <div class="analysis-meta"><div class="analysis-meta-label" style="color:var(--accent4)">Resolution</div><div class="analysis-meta-val">10kb â€“ 40kb</div></div>
    </div>
  </div>

  <div class="analysis-card" style="margin-top:0.75rem">
    <div class="analysis-header">
      <div class="analysis-accent" style="background:var(--accent1)"></div>
      <div class="analysis-header-body">
        <div class="analysis-title" style="color:var(--accent1)">ğŸ“Š &nbsp; Insulation Score Profiling</div>
        <p class="analysis-desc">Compute a continuous genome-wide insulation score using a sliding diamond window. Local minima mark TAD boundaries. This quantitative metric enables direct comparison of boundary strength across conditions, unlike discrete domain calls.</p>
      </div>
    </div>
    <div class="analysis-tools">
      <div class="analysis-tools-label">Tools</div>
      <div class="tool-pills">
        <span class="tool-pill" style="border-color:var(--accent1);color:var(--accent1)">cooltools insulation</span>
        <span class="tool-pill" style="border-color:var(--accent1);color:var(--accent1)">cooltools diamond-insulation</span>
      </div>
    </div>
    <div class="analysis-footer">
      <div class="analysis-meta"><div class="analysis-meta-label" style="color:var(--accent1)">Input</div><div class="analysis-meta-val">.mcool (5kbâ€“25kb)</div></div>
      <div class="analysis-meta"><div class="analysis-meta-label" style="color:var(--accent1)">Output</div><div class="analysis-meta-val">Bedgraph (score)</div></div>
      <div class="analysis-meta"><div class="analysis-meta-label" style="color:var(--accent1)">Resolution</div><div class="analysis-meta-val">5kb â€“ 25kb</div></div>
    </div>
  </div>

  <!-- PHASE 3 -->
  <div class="section-title">
    <div class="section-num">Phase 3</div>
    <h2>Point Interactions <span style="color:var(--muted);font-weight:400;font-size:0.9rem">â€” 5â€“50 kb resolution</span></h2>
    <div class="section-line"></div>
  </div>

  <div class="analysis-card">
    <div class="analysis-header">
      <div class="analysis-accent" style="background:var(--accent3)"></div>
      <div class="analysis-header-body">
        <div class="analysis-title" style="color:var(--accent3)">ğŸ”— &nbsp; Chromatin Loop Calling</div>
        <p class="analysis-desc">Detect point interactions between pairs of loci appearing as dots on the contact heatmap. Loops frequently link enhancers to promoters or connect convergent CTCF anchors. Requires deep sequencing (&gt;300M valid pairs) for reliable detection. Filter loops &lt; 25kb to exclude self-ligation noise.</p>
      </div>
    </div>
    <div class="analysis-tools">
      <div class="analysis-tools-label">Tools</div>
      <div class="tool-pills">
        <span class="tool-pill" style="border-color:var(--accent3);color:var(--accent3)">MUSTACHE</span>
        <span class="tool-pill" style="border-color:var(--accent3);color:var(--accent3)">HiCCUPS (Juicer)</span>
        <span class="tool-pill" style="border-color:var(--border);color:var(--muted)">SIP</span>
        <span class="tool-pill" style="border-color:var(--border);color:var(--muted)">LoopSage</span>
      </div>
    </div>
    <div class="analysis-footer">
      <div class="analysis-meta"><div class="analysis-meta-label" style="color:var(--accent3)">Input</div><div class="analysis-meta-val">.mcool (5kbâ€“10kb)</div></div>
      <div class="analysis-meta"><div class="analysis-meta-label" style="color:var(--accent3)">Output</div><div class="analysis-meta-val">BEDPE (loop pairs)</div></div>
      <div class="analysis-meta"><div class="analysis-meta-label" style="color:var(--accent3)">Resolution</div><div class="analysis-meta-val">5kb â€“ 10kb</div></div>
    </div>
  </div>

  <div class="analysis-card" style="margin-top:0.75rem">
    <div class="analysis-header">
      <div class="analysis-accent" style="background:var(--accent2)"></div>
      <div class="analysis-header-body">
        <div class="analysis-title" style="color:var(--accent2)">ã€° &nbsp; Stripe Detection</div>
        <p class="analysis-desc">Identify asymmetric linear features (stripes) emanating from strong CTCF anchors or cohesin loading sites. Stripes are a hallmark of active loop extrusion and differ from point loops by their one-dimensional appearance on the heatmap. Validate visually in HiGlass.</p>
      </div>
    </div>
    <div class="analysis-tools">
      <div class="analysis-tools-label">Tools</div>
      <div class="tool-pills">
        <span class="tool-pill" style="border-color:var(--accent2);color:var(--accent2)">stripenn</span>
        <span class="tool-pill" style="border-color:var(--border);color:var(--muted)">LoopSage</span>
      </div>
    </div>
    <div class="analysis-footer">
      <div class="analysis-meta"><div class="analysis-meta-label" style="color:var(--accent2)">Input</div><div class="analysis-meta-val">.mcool (5kbâ€“10kb)</div></div>
      <div class="analysis-meta"><div class="analysis-meta-label" style="color:var(--accent2)">Output</div><div class="analysis-meta-val">BEDPE (stripe anchors)</div></div>
      <div class="analysis-meta"><div class="analysis-meta-label" style="color:var(--accent2)">Resolution</div><div class="analysis-meta-val">5kb â€“ 10kb</div></div>
    </div>
  </div>

  <!-- PHASE 4 â€” Differential -->
  <div class="section-title">
    <div class="section-num">Phase 4</div>
    <h2>Differential Analysis <span style="color:var(--muted);font-weight:400;font-size:0.9rem">â€” Multi-condition</span></h2>
    <div class="section-line"></div>
  </div>

  <div class="notice warn">
    <div class="notice-icon">âš </div>
    <p><strong>Requirements:</strong> Differential analysis requires &ge;2 biological replicates per condition and equal sequencing depth (normalize to the same number of valid pairs before comparison). FDR &lt; 0.05 and fold-change &gt; 1.5 are standard thresholds.</p>
  </div>

  <div class="grid-2">
    <div class="info-card" style="border-color:rgba(99,179,237,0.3)">
      <h4 style="color:var(--accent6)">Differential Compartments</h4>
      <p>Compare eigenvectors between conditions. Aâ†’B switching = gene silencing. Bâ†’A = de-repression. Validate with RNA-seq fold-changes at switched loci.</p>
      <p style="margin-top:0.5rem"><span class="tag tag-amber">Tool:</span> cooltools eigs-cis (both conditions)</p>
    </div>
    <div class="info-card" style="border-color:rgba(159,122,234,0.3)">
      <h4 style="color:var(--accent3)">Differential Loops & TADs</h4>
      <p>Count-based statistical testing for loop strength changes. TAD boundaries that shift or dissolve between conditions.</p>
      <p style="margin-top:0.5rem"><span class="tag tag-amber">Tool:</span> diffHic (R/Bioconductor), MUSTACHE diff</p>
    </div>
  </div>

  <!-- PHASE 5 â€” Visualization -->
  <div class="section-title">
    <div class="section-num">Phase 5</div>
    <h2>Visualization</h2>
    <div class="section-line"></div>
  </div>

  <div class="grid-2">
    <div class="info-card" style="border-color:rgba(79,209,197,0.3)">
      <h4 style="color:var(--accent1)">HiGlass <span style="font-weight:400;color:var(--muted);font-size:0.8rem">â€” Recommended</span></h4>
      <p>Web-based interactive 3D genome browser. Side-by-side matrix comparison, overlay gene tracks, loop annotations, insulation scores.</p>
      <p style="margin-top:0.5rem;font-family:var(--mono);font-size:12px;color:var(--muted)">Input: .mcool + bedgraph + BEDPE</p>
    </div>
    <div class="info-card" style="border-color:rgba(159,122,234,0.3)">
      <h4 style="color:var(--accent3)">Juicebox</h4>
      <p>Desktop app from Aiden Lab. Strong loop inspection tools. Requires conversion to .hic format via hic-straw. Best for paper figures.</p>
      <p style="margin-top:0.5rem;font-family:var(--mono);font-size:12px;color:var(--muted)">Input: .hic (convert from .mcool)</p>
    </div>
    <div class="info-card" style="border-color:rgba(246,173,85,0.3)">
      <h4 style="color:var(--accent2)">cooltools + matplotlib</h4>
      <p>Programmatic figure generation. Overlay contact matrices with gene models, ChIP peaks, called TAD boundaries and loops in one composite figure.</p>
      <p style="margin-top:0.5rem;font-family:var(--mono);font-size:12px;color:var(--muted)">Python: cooltools.plotting + pyGenomeTracks</p>
    </div>
    <div class="info-card" style="border-color:rgba(104,211,145,0.3)">
      <h4 style="color:var(--accent4)">Assembly Scaffolding</h4>
      <p>For de novo genome projects, use Omni-C contacts to order and orient draft contigs into chromosome-scale scaffolds.</p>
      <p style="margin-top:0.5rem;font-family:var(--mono);font-size:12px;color:var(--muted)">Tools: SALSA2 Â· YaHS Â· 3D-DNA</p>
    </div>
  </div>

  <!-- INTEGRATION -->
  <div class="section-title">
    <div class="section-num">06</div>
    <h2>Multi-Omics Integration</h2>
    <div class="section-line"></div>
  </div>

  <div class="integration-grid">
    <div class="ig-cell ig-head">Omni-C Feature</div>
    <div class="ig-cell ig-head">Integrate With</div>
    <div class="ig-cell ig-head">Combined Insight</div>
    <div class="ig-cell"><div class="ig-main">Loops (E-P)</div></div>
    <div class="ig-cell"><div class="ig-main">RNA-seq</div></div>
    <div class="ig-cell"><div class="ig-sub">Active enhancerâ€“gene regulatory links</div></div>
    <div class="ig-cell"><div class="ig-main">A/B Compartments</div></div>
    <div class="ig-cell"><div class="ig-main">ChIP-seq (H3K27ac)</div></div>
    <div class="ig-cell"><div class="ig-sub">Active vs. silent chromatin landscape</div></div>
    <div class="ig-cell"><div class="ig-main">TAD boundaries</div></div>
    <div class="ig-cell"><div class="ig-main">CTCF ChIP-seq</div></div>
    <div class="ig-cell"><div class="ig-sub">Insulator function validation</div></div>
    <div class="ig-cell"><div class="ig-main">Compartment changes</div></div>
    <div class="ig-cell"><div class="ig-main">ATAC-seq</div></div>
    <div class="ig-cell"><div class="ig-sub">Chromatin accessibility remodeling</div></div>
    <div class="ig-cell"><div class="ig-main">Loops (differential)</div></div>
    <div class="ig-cell"><div class="ig-main">Hi-ChIP / CUT&RUN</div></div>
    <div class="ig-cell"><div class="ig-sub">Factor-specific loop validation</div></div>
    <div class="ig-cell"><div class="ig-main">Insulation score</div></div>
    <div class="ig-cell"><div class="ig-main">eQTL / GWAS</div></div>
    <div class="ig-cell"><div class="ig-sub">Variant impact on 3D genome structure</div></div>
  </div>

  <!-- DEPTH GUIDE -->
  <div id="tools"></div>
  <div class="section-title">
    <div class="section-num">07</div>
    <h2>Sequencing Depth Guide</h2>
    <div class="section-line"></div>
  </div>

  <div class="depth-card">
    <div class="depth-row hdr"><div>Valid Pairs</div><div>Achievable Analysis</div><div>Notes</div></div>
    <div class="depth-row"><div>50 â€“ 100M</div><div>Compartments only</div><div>Reliable A/B compartments; TADs and loops unreliable at this depth</div></div>
    <div class="depth-row"><div>100 â€“ 300M</div><div>Compartments + TADs</div><div>Robust TADs at 10â€“25kb; loop calling marginal â€” use with caution</div></div>
    <div class="depth-row"><div>300M â€“ 1B</div><div>Full feature suite</div><div>Reliable loops; recommended depth for most 3D genome studies</div></div>
    <div class="depth-row"><div>&gt; 1B</div><div>Ultra-high resolution</div><div>Sub-5kb loops; sub-compartment analysis; allele-specific contacts</div></div>
  </div>

  <div class="notice tip" style="margin-top:1.5rem">
    <div class="notice-icon">ğŸ’¡</div>
    <p><strong>Best practices:</strong> Always analyze at multiple resolutions. Validate loops with two independent callers. Use â‰¥ 2 biological replicates for any differential claim. Cross-validate A compartments with gene expression. Deposit both raw and balanced matrices on GEO/SRA.</p>
  </div>

</div><!-- end panel-downstream -->

</main>

<footer>
  <div class="footer-inner">
    <div class="footer-author">
      <div class="footer-avatar">M</div>
      <div>
        <div class="footer-name">Mai TN Nguyen</div>
        <div class="footer-links">
          <a class="footer-link" href="https://github.com/maitnnguyen" target="_blank">
            <svg width="13" height="13" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0 0 24 12c0-6.63-5.37-12-12-12z"/></svg>
            maitnnguyen
          </a>
          <a class="footer-link" href="mailto:ntnmai303@gmail.com">
            <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
            ntnmai303@gmail.com
          </a>
        </div>
      </div>
    </div>
    <div class="footer-right">
      Omni-C Bioinformatics Pipeline<br>
      pairtools Â· cooler Â· Dovetail Genomics protocol
    </div>
  </div>
</footer>

<script>
function showTab(tab) {
  document.querySelectorAll('.tab-btn').forEach((b,i) => {
    b.classList.toggle('active', (i === 0 && tab === 'preprocessing') || (i === 1 && tab === 'downstream'));
  });
  document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
  document.getElementById('panel-' + tab).classList.add('active');
  window.scrollTo({ top: document.querySelector('main').offsetTop - 80, behavior: 'smooth' });
}
</script>
</body>
</html>
